import requests
from googletrans import Translator
from concurrent.futures import ThreadPoolExecutor, as_completed

# ë²ˆì—­ê¸°
translator = Translator()

# ë²ˆì—­ í•¨ìˆ˜
def translate(text):
    return translator.translate(text, src='ko', dest='en').text

# AI ê°ì§€ í•¨ìˆ˜
def detect_ai_score(text, api_key):
    response = requests.post(
        "https://api.sapling.ai/api/v1/aidetect",
        json={
            "key": api_key,
            "text": text
        }
    )
    result = response.json()
    return round(result["score"] * 100, 2) if "score" in result else None

# ì „ì²´ ì²˜ë¦¬ í•¨ìˆ˜
def process_review(korean_text, api_key):
    try:
        english_text = translate(korean_text)
        score = detect_ai_score(english_text, api_key)
        return {
            "original_korean": korean_text,
            "translated_english": english_text,
            "ai_score_percent": score
        }
    except Exception as e:
        return {
            "original_korean": korean_text,
            "error": str(e)
        }

# ì‹¤í–‰ë¶€
if __name__ == "__main__":
    api_key = "ZH5PGVIA3OYKV95LSU6TFNYOP2XMHO8Q"  # ë³¸ì¸ í‚¤ë¡œ ë³€ê²½

    # í…ŒìŠ¤íŠ¸ìš© ë¦¬ë·° ë¦¬ìŠ¤íŠ¸ (50~100ê°œê¹Œì§€ í™•ì¥ ê°€ëŠ¥)
    review_list = [
        ""
        # ... ìµœëŒ€ 100ê°œê¹Œì§€
    ]

    results = []

    print("ğŸ”„ ë³‘ë ¬ ì²˜ë¦¬ ì¤‘...")
    with ThreadPoolExecutor(max_workers=10) as executor:
        future_to_review = {executor.submit(process_review, review, api_key): review for review in review_list}
        for future in as_completed(future_to_review):
            result = future.result()
            results.append(result)
            print(f"âœ… ì™„ë£Œ: {result.get('original_korean')} â†’ {result.get('ai_score_percent', 'ì‹¤íŒ¨')}%")

    # ì „ì²´ ê²°ê³¼ ì¶œë ¥
    print("\nğŸ“Š ì „ì²´ ìš”ì•½:")
    for r in results:
        print(f"{r['original_korean']} â†’ {r.get('ai_score_percent', 'ì—ëŸ¬')}%")
